<Window x:Class="LettreProfessionel.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:local="clr-namespace:LettreProfessionel"
        xmlns:wv2="clr-namespace:Microsoft.Web.WebView2.Wpf;assembly=Microsoft.Web.WebView2.Wpf"
        mc:Ignorable="d"
        Title="Lettre Professionnelle" 
        WindowStartupLocation="CenterScreen"
        Height="700" 
        Width="1280">

    <Grid>

        <Grid.RowDefinitions>
            <RowDefinition Height="auto"/>
            <RowDefinition Height="auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="25"/>
        </Grid.RowDefinitions>

        <!-- Status bar 1 : nom du modèle -->
        <StatusBar Grid.Row="0" 
                   Background="#31628C" 
                   Height="30">

            <StatusBarItem HorizontalContentAlignment="Center"
                           VerticalContentAlignment="Center">

                <TextBlock x:Name="StatusText" 
                   Foreground="White"
                   FontWeight="DemiBold"
                   Text="Modèle de Lettre"/>
            </StatusBarItem>
        </StatusBar>


        <!-- Barre d’outils -->
        <ToolBarTray Grid.Row="1"
             Background="#31628C">

            <ToolBar Margin="0 0 0 15"
                     Background="#31628C">

                <!--NewDocument-->
                <Button ToolTip="Nouveau Document"
                        Cursor="Hand"
                        Width="70"
                        Click="NewDocument_Click"
                        Background="#EEF5FD"
                        Margin="0 0 5 0">
                    
                    <StackPanel Orientation="Vertical" VerticalAlignment="Center">
                        <Image Source="/Assets/Icons/newDocument.png" Width="40"/>
                        <TextBlock Text="Nouveau" 
                           FontSize="9"
                           VerticalAlignment="Center" 
                           FontFamily="Montserrat"
                           Margin="5 5 0 0"/>
                    </StackPanel>
                </Button>

                <!-- Imprimer -->
                <Button ToolTip="Imprimer" 
                        Click="Print_Click"
                        Cursor="Hand"
                        Width="70"
                        Background="#EEF5FD"
                        Margin="0 0 5 0">

                    <StackPanel Orientation="Vertical" VerticalAlignment="Center">
                        <Image Source="pack://application:,,,/Assets/Icons/pdf.png" Width="40"/>

                        <TextBlock Text="Imprimer" 
                           FontSize="9"
                           VerticalAlignment="Center" 
                           FontFamily="Montserrat"
                           Margin="5 5 0 0"/>
                    </StackPanel>
                </Button>

                <!-- Email -->
                <Button ToolTip="Email"
                        Background="#EEF5FD"
                        Margin="0 0 5 0"
                        Cursor="Hand"
                        Width="70"
                        >

                    <StackPanel Orientation="Vertical" VerticalAlignment="Center">
                        <Image Source="pack://application:,,,/Assets/Icons/outlook.png" Width="40"/>

                        <TextBlock Text="Email"
                           FontSize="9"
                           VerticalAlignment="Center"
                           FontFamily="Montserrat"
                           Margin="9 5 0 0"/>
                    </StackPanel>
                </Button>

                <!-- Word -->
                <Button ToolTip="Word"
                        Background="#EEF5FD"
                        Margin="0 0 5 0"
                        Cursor="Hand"
                        Width="70">

                    <StackPanel Orientation="Vertical" VerticalAlignment="Center">
                        <Image Source="pack://application:,,,/Assets/Icons/ms-word.png" Width="40"/>

                        <TextBlock Text="Word"
                           FontSize="9"
                           VerticalAlignment="Center"
                           FontFamily="Montserrat"
                           Margin="7 5 0 0"/>
                    </StackPanel>
                </Button>

                <!-- Paramètre -->
                <Button ToolTip="Paramètre"
                        Background="#EEF5FD"
                        Cursor="Hand"
                        Width="70">

                    <StackPanel Orientation="Vertical" VerticalAlignment="Center">
                        <Image Source="pack://application:,,,/Assets/Icons/parametre.png" Width="40"/>

                        <TextBlock Text="Paramètre"
                           FontSize="9"
                           VerticalAlignment="Center"
                           FontFamily="Montserrat"
                           Margin="0 5 0 0"/>
                    </StackPanel>
                </Button>
            </ToolBar>
        </ToolBarTray>

        <!-- LogoLettrePro -->
        <Image 
               VerticalAlignment="Top"
               Margin="854,7,-1,0"
              
               Source="/Assets/Icons/LettrePro.jpg" 
               Height="100" Grid.RowSpan="2"/>


        <!-- Contenu principal -->
        <Grid Grid.Row="2" >
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="250"/>
                <ColumnDefinition Width="2"/>
                <ColumnDefinition Width="*"/>
            </Grid.ColumnDefinitions>

            <!-- Liste des lettres -->

            <StackPanel Grid.Column="0" 
                    Background="#C6C9D2">

                <TextBox Margin="10" 
                     Height="25" 
                     Text="Rechercher..." />

                <ScrollViewer Height="500">
                    <ListBox x:Name="LettresList" 
                     Margin="10" 
                     SelectionChanged="LettresList_SelectionChanged"/>
                </ScrollViewer>
            </StackPanel>


            <!-- Séparateur -->
            <GridSplitter Grid.Column="1" 
                          Background="#C6C6C6"
                          HorizontalAlignment="Stretch"
                          VerticalAlignment="Stretch"
                          ResizeBehavior="PreviousAndNext"
                          ShowsPreview="True" Cursor="SizeWE"/>

            <!-- Contenu de la lettre -->
            <Grid Grid.Column="2" 
                  Background="#E6E6E6">

                <Grid.RowDefinitions>
                    <RowDefinition Height="50"/>
                    <RowDefinition Height="*"/>
                </Grid.RowDefinitions>

                <!--les commandes d'edition de texte-->
                <Border Grid.Row="0"
                        Background="#F3F3F3"
                        BorderThickness="0.8"
                        BorderBrush="#C6C6C6"
                        Padding="2">

                    <ToolBar Background="Transparent"
                             Margin="60 0 0 0">

                        <Button ToolTip="Annuler" 
                                 Cursor="Hand"
                                Click="Undo_Click">

                            <Image Source="/Assets/Icons/icon-undo.png" 
                                   Width="20"/>
                        </Button>

                        <Button ToolTip="Refaire" 
                                Cursor="Hand"
                                Click="Redo_Click">

                            <Image Source="/Assets/Icons/icon-redo.png" 
                                   Width="20"/>
                        </Button>

                        <Separator/>

                        <Button ToolTip="Aligner à gauche"
                                Cursor="Hand"
                                Click="AlignLeft_Click">

                            <Image Source="/Assets/Icons/icon-align-left.png" 
                                   Width="20"/>
                        </Button>

                        <Button ToolTip="Centrer" 
                                 Cursor="Hand"
                                Click="AlignCenter_Click">

                            <Image Source="/Assets/Icons/icon-align-center.png" 
                                   Width="20"/>
                        </Button>

                        <Button ToolTip="Aligner à droite" 
                                 Cursor="Hand"
                                Click="AlignRight_Click">

                            <Image Source="/Assets/Icons/icon-align-right.png" 
                                   Width="20"/>
                        </Button>

                        <Button ToolTip="Justifier" 
                                 Cursor="Hand"
                                Click="AlignJustify_Click">

                            <Image Source="/Assets/Icons/icon-align-justify.png" 
                                   Width="20"/>
                        </Button>

                        <Separator/>

                        <Button ToolTip="Gras" 
                                 Cursor="Hand"
                                Click="Bold_Click">

                            <Image Source="/Assets/Icons/icon-bold.png" 
                                   Width="20"/>
                        </Button>

                        <Button ToolTip="Italique" 
                                 Cursor="Hand"
                                Click="Italic_Click">

                            <Image Source="/Assets/Icons/icon-italic.png" 
                                   Width="20"/>
                        </Button>

                        <Button ToolTip="Souligné" 
                                 Cursor="Hand"
                                Click="Underline_Click">

                            <Image Source="/Assets/Icons/icon-underline.png" 
                                   Width="20"/>
                        </Button>

                        <Separator/>

                        <Button ToolTip="Liste a puces" 
                                 Cursor="Hand"
                                Click="bulletList_Click">

                            <Image Source="/Assets/Icons/icon-bullet-list.png" 
                                   Width="20"/>
                        </Button>

                        <Button ToolTip="Liste a nombres" 
                                 Cursor="Hand"
                                Click="numberedList_Click">

                            <Image Source="/Assets/Icons/icon-numbered-list.png" 
                                   Width="20"/>
                        </Button>

                        <Separator/>

                        <Button ToolTip="Lien" 
                                 Cursor="Hand"
                                Click="lien_Click">

                            <Image Source="/Assets/Icons/icon-lien.png" 
                                   Width="20"/>
                        </Button>

                    </ToolBar>


                </Border>


                <!-- afficher le contenu -->
                <Border Grid.Row="1"
                        Margin="70 20 70 10"
                        BorderThickness="0.8"
                        BorderBrush="#C6C6C6">

                    <wv2:WebView2 x:Name="HtmlViewer"/>
                </Border>
            </Grid>


        </Grid>

        <!-- Status bar 2 : chemin du fichier -->
        <StatusBar Grid.Row="3" 
                   Background="#F3F3F3" 
                   Height="30"
                   BorderThickness="0.8"
                   BorderBrush="#C6C6C6"
                   HorizontalContentAlignment="Left"
                   VerticalContentAlignment="Center">

            <StatusBarItem>
                <TextBlock x:Name="LetterInfoText" 
                             Text=""/>
            </StatusBarItem>
        </StatusBar>

    </Grid>
</Window>
